function openMenu(a){}function CreateUsageGraph(a){var b=["#acacac","#34C6CD","#FFB473","#2A4380","#FFD173","#0199AB","#FF7600","#123EAB","#FFAB00","#1A7074","#A64D00","#466FD5","#BE008A","#B4F200","#DF38B1","#EF002A"],c=new google.visualization.DataTable;c.addColumn("string","Week Start");var d=2*Math.PI/a[0].length;for(var e=1;e<a[0].length;e++){var f=Math.sin(e*d+0)*127+128,g=Math.sin(e*d+2)*127+128,h=Math.sin(e*d+4)*127+128;c.addColumn("number",a[0][e]),b.push(RGB2Color(f,g,h))}for(var e=1;e<a.length;e++)c.addRows([a[e]]);var i={backgroundColor:"#efeeef",title:"Distinct Logins a day by group by week",titlePosition:"out",colors:b,lineWidth:3,width:"100%",height:"100%",curveType:"function",explorer:{},hAxis:{textPosition:"none",slantedText:!0,slantedTextAngle:60},legend:{position:"top",textStyle:{fontSize:13}},chartArea:{left:60,top:70,width:"100%",height:"90%"},animation:{duration:1e3,easing:"out"},vAxis:{title:"Distinct Users"}},j=new google.visualization.LineChart(document.getElementById("usageByTime"));j.draw(c,i);var k=document.createElement("table");$(k).addClass("grid");for(var e=0;e<a[1].length;e++){var l=document.createElement("tr");for(var m=0;m<a.length;m++){var n=document.createElement("td");e==0&&(n=document.createElement("th")),$(n).addClass("graphCellHover"),$(n).hover(function(){$(this).closest("tr").addClass("graphRowHover")},function(){$(this).closest("tr").removeClass("graphRowHover")}),n.appendChild(document.createTextNode(a[m][e]));if(m===0){var o=UsersByGroup(a[m][e]);$(n).css("width","100px"),e!==0&&$(n).addClass("showing").addClass("rowHeader").attr("id","t"+e).attr("title","Hide/Show on graph \n\n"+UsersByGroup(a[m][e])),function(a,b,c){$(n).click(function(){view=new google.visualization.DataView(a),$(this).hasClass("showing")?$(this).closest("tr").find("td").each(function(){$(this).removeClass("showing").removeClass("graphCellHover").addClass("grapCellhHoverNotShow")}):$(this).closest("tr").find("td").each(function(){$(this).removeClass("grapCellhHoverNotShow").addClass("showing").addClass("graphCellHover")});var c=new Array;$(".rowHeader").each(function(){$(this).hasClass("showing")||c.push(parseInt($(this).attr("id").substr(1,$(this).attr("id").length-1)))}),view.hideColumns(c),j.draw(view,b)})}(c,i,e)}else $(n).addClass("cellNumberTight"),e>0&&($(n).attr("id","cell"+e+","+m),$(n).mouseover(function(){var a=j.series,b=$(this).attr("id").substr(4,$(this).attr("id").length-4).split(",")}));l.appendChild(n)}k.appendChild(l)}$("#graphDetails").html(k),$("#showFullScreen").on("click",function(a){$("#usageByTime").removeClass("graph").css({position:"fixed",left:0,top:0,"z-index":5,width:"100%",height:"100%",margin:0}),$(this).css("z-index",1);var b=document.createElement("div");$(b).addClass("float-right-absolute").click(function(){$("#usageByTime").css({position:"",left:"",top:"","z-index":"",width:"",height:"",margin:""}).addClass("graph"),$("#closeButtonDiv").remove(),j.draw(c,i),$("#showFullScreen").css("z-index",10)}).css({"min-width":"20px","min-height":"20px","background-image":"url(../Images/x-circle.png)","background-size":"cover",cursor:"pointer"}).attr("id","closeButtonDiv"),b.appendChild(document.createTextNode("  ")),document.body.appendChild(b),j.draw(c,i)})}function getUsageByWeeksJson(){var a=new Array,b=new Array,c=new Array;setTimeout(function(){$.ajax({type:"GET",contentType:"application/json; charset=utf-8",url:"GetUsageByWeeks",async:!1,success:function(a){var b=new Array,c=new Array,d=new Array;c.push("Week Start");for(var e=0;e<a.length;e++)jQuery.inArray(a[e].WeekStart,b)===-1&&b.push(a[e].WeekStart),jQuery.inArray(a[e].Group,c)===-1&&c.push(a[e].Group);var f=c.slice(0);d.push(f),c.shift();for(var e=0;e<b.length;e++){var g=new Array;g.push(b[e]);for(var h=0;h<c.length;h++)g.push(a[e*c.length+h].DistinctLogins);d.push(g)}CreateUsageGraph(d)},error:function(a,b,c){var d=new ErrorInsert;d.PageName="Index",d.StepName="ajaxGetUsageByWeeks",d.ErrorDetails=a.responseText+" -- "+c,a.readyState==4&&(d.ErrorCode="c-g-j-ageubw-01")}})},5)}function UsersByGroup(a){var b="";return $.ajax({type:"POST",data:{userGroup:a},url:"GetUsersInGroup",async:!1,success:function(a){for(var c=0;c<a.length;c++)b+=a[c]+"\n"},error:function(a,b,c){var d=new ErrorInsert;d.PageName="Index",d.StepName="ajaxGetUsageByWeeks",d.ErrorDetails=a.responseText+" -- "+c,a.readyState==4&&(d.ErrorCode="c-g-j-ageubw-01")}}),b}function RGB2Color(a,b,c){return"#"+byte2Hex(a)+byte2Hex(b)+byte2Hex(c)}function byte2Hex(a){var b="0123456789ABCDEF";return String(b.substr(a>>4&15,1))+b.substr(a&15,1)}function expandCollapse(a,b,c){setTimeout(loadStart(),500),setTimeout(function(){b.src.match("expand")?(b.src="../../Images/collapse.gif",$("#"+a+" > tbody > tr").each(function(){$(this).attr("id")===c&&$(this).show()})):(b.src="../../Images/expand.gif",$("#"+a+" > tbody > tr").each(function(){$(this).attr("id")===c&&$(this).hide()}))},1e3),setTimeout(loadEnd(),1e4)}google.load("visualization","1.0",{packages:["corechart"]}),$(document).ready(function(){getUsageByWeeksJson(),loadEnd()})